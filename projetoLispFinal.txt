; CAROLINE NAKAZATO RA: 17164260
; FÁBIO    IROKAWA  RA: 17057720

;;;;;;;;;;;;;;;;;;;;;;;;;GLOSSÁRIO;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
; TUDO DE UMA DISCIPLINA (cadar '((1((2) (3) . 4))))     > (((2) (3).4)) 
; DISCIPLINA     (caar   '((1((2) (3) . 4))))            > 1 
; ALUNOS         (caadar '((1((2) (3) . 4))))            > (2) 
; PRIMEIRO ALUNO (car  (caadar '((1((2 6 7) (3) . 4))))) > 2
; OUTROS ALUNOS  (cdr  (caadar '((1((2 6 7) (3) . 4))))) > (6 7)
; PROFESSORES    (car  (cdadar '((1((2) (3) . 4)))))     > (3) 
; PRIMEIRO PROF  (caar (cdadar '((1((2) (3) . 4)))))     > 3
; OUTROS PROF    (cdar (cdadar '((1((2) (3 5) . 4)))))   > (5)
; CURSO          (cdr  (cdadar '((1((2) (3) . 4)))))     > 4 	

;INSERE UM CURSO EM UMA DISCIPLINA
(DEFUN VINCULAR-DISC-CURSO(DISCIPLINA CURSO BD) 
	(if (eql (caar BD) DISCIPLINA)
		(if (null(cdr (cdadar BD))) ; CURSO VAZIO
			(cons (cons DISCIPLINA 
						(cons (cons (cons (car (caadar BD)) (cdr (caadar BD)) )
						(cons (cons (caar (cdadar BD)) (cdar (cdadar BD))) 
						 CURSO)) nil)) (cdr BD)) ; INSERE UM CURSO 
			(cons (car BD) (cdr BD))             ; JÁ EXISTE CURSO P/ ESTA DISCIPLINA
		)
		(if(null(car BD))
			(cons (cons DISCIPLINA (cons (cons (cons nil nil) 
								 (cons (cons nil nil) CURSO)) 
			nil)) nil) ; DISCIPLINA NÃO EXISTE
			(cons (car BD) (VINCULAR-DISC-CURSO DISCIPLINA CURSO (cdr BD))) ; PEGO A PROXIMA DISCIPLINA
		)
	)
)

; TESTES
; INSERE CURSO SEM DISCIPLINA
;(VINCULAR-DISC-CURSO 'CALCULO 'ENGENHARIA '())
;(VINCULAR-DISC-CURSO 'CALCULO 'ENGENHARIA '((APC ((CAROL) (PATRICIA) ))))

; INSERE CURSO COM A DISCIPLINA, MAS JA EXISTE UM CURSO
;(VINCULAR-DISC-CURSO 'CALCULO 'ENGENHARIA '((CALCULO ((CAROL) (OTAVIO) PROD))))

; INSERE CURSO COM A DISCIPLINA, MAS SEM UM CURSO
;(VINCULAR-DISC-CURSO 'CALCULO 'ENGENHARIA '((CALCULO ((CAROL) (OTAVIO) ))))

; VERIFICA SE UM ELEMENTO EXISTE EM UMA LISTA SIMPLES
(DEFUN existe (l a)
	(if(null(car l))
		nil	            ; SE NÃO EXISTIR MAIS LISTA RETORNA NIL
		(if(eql (car l ) a)
			t 			; SE ELEMENTO FOR IGUAL RETORNA TRUE
			(existe (cdr l) a) ; PEGA O PROXIMO ELEMENTO DA LISTA
		)
	)
)

; TESTE
; (EXISTE '(1 2 3) 1)
; (EXISTE '(1 2 3) 0)

; INSERE UM ALUNO EM UMA DISICIPLINA
(DEFUN insereM (l d a)
	(if (eql (caar l) d)     ; SE FOR A DISCIPLINA
		(if (null(caadar l)) ; VERIFICO SE EXISTEM ALUNOS
			(cons (cons d (cons (cons (cons a nil)
									(cons (cons (caar (cdadar l)) (cdar (cdadar l))) 
									(cdr (cdadar l)))) 
			nil)) (cdr l))             ; NÃO EXISTE NENHUM ALUNO
			(if (existe (caadar  l) a) ; VERIFICO SE O ALUNO QUE DESEJO INCLUIR JÁ EXISTE NA LISTA
				(cons (car l) (cdr l)) ; ALUNO JÁ EXISTE
				(cons (cons d (cons (cons (cons a (cons (car (caadar l)) (cdr (caadar l)) ))
									(cons (cons (caar (cdadar l)) (cdar (cdadar l))) 
									(cdr (cdadar l)))) 
				nil)) (cdr l))         ; EXISTEM OUTROS ALUNOS, MAS NAO AQUELE QUE DESEJO INSERIR
			)
		)
		(if(null(car l))
			(cons (cons d (cons (cons (cons a nil) 
								 (cons (cons nil nil) nil)) 
			nil)) nil) ; DISCIPLINA NÃO EXISTE
			(cons (car l) (insereM (cdr l) d a)) ; PEGO A PROXIMA DISCIPLINA
		)
	)
)

; TESTES
; INSERE ALUNO SEM DISCIPLINA
; (insereM '() 'CALCULO 'CAROL )
; (insereM '((APC ((CAROL) (PATRICIA) ))) 'CALCULO 'CAROL )

; INSERE ALUNO NA DISCIPLINA, MAS JA EXISTE O ALUNO
; (insereM  '((CALCULO ((CAROL) (OTAVIO) COMP))) 'CALCULO 'CAROL )

; INSERE ALUNO COM A DISCIPLINA
; (insereM  '((CALCULO (() (OTAVIO) COMP))) 'CALCULO 'CAROL )
; (insereM  '((CALCULO ((FABIO) (OTAVIO) COMP))) 'CALCULO 'CAROL )
; (insereM  '((APC ((FABIO) (PATRICIA) COMP)) (CALCULO ((FABIO) (OTAVIO) COMP))) 'CALCULO 'CAROL )

; INSERE UM ALUNO EM VARIAS DISCIPLINAS
(DEFUN VINCULAR-DISC-ALUNO (DISCIPLINAS ALUNO BD) 
	(IF(NULL (CAR DISCIPLINAS)) ; VERIFICO SE A LISTA DE DISCIPLINAS ESTÁ VAZIA
		(CONS (car BD) (cdr BD)) 
		(VINCULAR-DISC-ALUNO (CDR DISCIPLINAS) ALUNO 
			(INSEREM BD (CAR DISCIPLINAS) ALUNO )) ; COLOCO UM ALUNO EM UMA DISCIPLINA
	)
)

; TESTE
; (VINCULAR-DISC-ALUNO '(CALCULO APC) 'CAROL '((CALCULO ((FABIO) (OTAVIO) COMP))) )

;INSERE VARIOS ALUNOS EM VARIAS DISCIPLINAS
(DEFUN MATRICULAR (ALUNOS DISCIPLINAS BD)
	(IF(NULL (CAR ALUNOS))
		(CONS (car BD) (cdr BD))
		(MATRICULAR (CDR ALUNOS) DISCIPLINAS
			(VINCULAR-DISC-ALUNO DISCIPLINAS (CAR ALUNOS)  BD)) 
	)
)

; TESTE
; (MATRICULAR '(CAROL FABIO) '(CALCULO APC) '((CALCULO ((FABIO) (OTAVIO) COMP))) )

;INSERE UM PROFESSOR EM UMA DISCIPLINA
(DEFUN insereP (l d p)
	(if (eql (caar l) d) ; SE FOR A DISCIPLINA
		(if (null(caadar l))  ; VEJO SE JA EXISTE ALGUM PROF
			(cons (cons d (cons (cons (cons (car (caadar l)) (cdr (caadar l)))
									(cons (cons p nil) 
									(cdr (cdadar l)))) 
			nil)) (cdr l))             ; NÃO EXISTE NENHUM PROFESSOR
			(if (existe (car (cdadar  l)) p)
				(cons (car l) (cdr l)) ; JA EXISTE O PROFESSOR
				(cons (cons d (cons (cons (cons (car (caadar l)) (cdr (caadar l)))
									(cons (cons p (cons (caar (cdadar l)) (cdar (cdadar l)))) 
									(cdr (cdadar l)))) 
				nil)) (cdr l)) ; EXISTEM OUTROS PROFESSORES, MAS NÃO AQUELE QUE DESEJO INSERIR
			)
		)
		(if(null(car l))
			(cons (cons d (cons (cons (cons nil nil) 
								 (cons (cons p nil) nil)) 
			nil)) nil) ; DISCIPLINA NÃO EXISTE
			(cons (car l) (insereP (cdr l) d p)) ; PEGO A PROXIMA DISCIPLINA
		)
	)
)

; TESTES
; INSERE PROFESSOR SEM DISCIPLINA
; (insereP '() 'CALCULO 'OTAVIO )
; (insereP '((APC ((CAROL) (PATRICIA) ))) 'CALCULO 'OTAVIO )

; INSERE PROFESSOR NA DISCIPLINA, MAS JA EXISTE O PROFESSOR
; (insereP  '((CALCULO ((CAROL) (OTAVIO) COMP))) 'CALCULO 'OTAVIO )

; INSERE PROFESSOR COM A DISCIPLINA
; (insereP  '((CALCULO ((CAROL) () COMP))) 'CALCULO 'OTAVIO )
; (insereP  '((CALCULO ((FABIO) (OTAVIO) COMP))) 'CALCULO 'MAGELA )
; (insereP  '((APC ((FABIO) (PATRICIA) COMP)) (CALCULO ((FABIO) (OTAVIO) COMP))) 'CALCULO 'MAGELA )

;INSERE UM PROFESSOR EM VARIAS DISCIPLINAS
(DEFUN VINCULAR-DISC-PROF (DISCIPLINAS PROF BD) 
	(IF(NULL (CAR DISCIPLINAS))
		(CONS (car BD) (cdr BD))
		(VINCULAR-DISC-PROF (CDR DISCIPLINAS) PROF 
			(INSEREP BD (CAR DISCIPLINAS) PROF )) 
	)
)

; TESTE
; (VINCULAR-DISC-PROF '(CALCULO_A CALCULO_B) 'OTAVIO '((CALCULO_A ((FABIO) (MAGELA) COMP))) )

;INSERE VARIOS PROFESSORES EM VARIAS DISCIPLINAS
(DEFUN VINCULAR (PROFESSORES DISCIPLINAS BD)
	(IF(NULL (CAR PROFESSORES))
		(CONS (car BD) (cdr BD))
		(VINCULAR (CDR PROFESSORES) DISCIPLINAS
			(VINCULAR-DISC-PROF DISCIPLINAS (CAR PROFESSORES)  BD)) 
	)
)

; TESTE
; (VINCULAR '(OTAVIO MAGELA) '(CALCULO FISICA) '((CALCULO ((FABIO) (OTAVIO) COMP))) )

;EXCLUI UM ELEMENTO DE UMA LISTA SIMPLES
(DEFUN EXCLUIR (L E) 
	(IF(NULL (CAR L))
		NIL
		(IF(EQL (CAR L) E) ; SE O ELEMENTO FOR IGUAL 
			(CDR L)  	   ; RETORNO A LISTA SEM O ELEMENTO
			(CONS (CAR L) (EXCLUIR (CDR L) E)) ; SE NÃO PEGO O PROX
		)
	)
)

; TESTE
; (EXCLUIR '(1 2 3) 2)
; (EXCLUIR '(1 2 3) 0)

; EXCLUI UM ALUNO DE UMA DISCIPLINA
(DEFUN EXCLUIRM (L D A)
	(if (eql (caar l) d)      ; SE FOR IGUAL A DISCIPLINA
		(if (null(caadar l))  ; VERIFICO SE EXISTE ALGUM ALUNO
			(cons (car l) (cdr l)) ; NÃO EXISTE NENHUM ALUNO
			(if (existe (caadar  l) a)
				(cons (cons d (cons (cons (EXCLUIR (caadar L) A)
									(cons (cons (caar (cdadar l)) (cdar (cdadar l))) 
									(cdr (cdadar l)))) 
				nil)) (cdr l))  ; EXISTE O ALUNO QUE DESEJO EXCLUIR
				(cons (car l) (cdr l)); EXISTEM OUTROS ALUNOS, MAS AQUELE QUE DESEJO EXCLUIR 
			)
		)
		(if(null(car l))
			(cons (car l) (cdr l)) ; DISCIPLINA NÃO EXISTE
			(cons (car l) (EXCLUIRM (cdr l) d a)) ; PEGO A PRÓXIMA DISCIPLINA
		)
	)
)

; TESTES
; ALUNO NÃO EXISTE NA DISCIPLINA
; (EXCLUIRM '() 'CALCULO 'CAROL )
; (EXCLUIRM '((APC ((CAROL) (PATRICIA) ))) 'CALCULO 'CAROL )
; (EXCLUIRM  '((CALCULO ((FABIO) () COMP))) 'CALCULO 'CAROL )

; EXCLUI ALUNO NA DISCIPLINA
; (EXCLUIRM  '((CALCULO ((CAROL) (OTAVIO) COMP))) 'CALCULO 'CAROL )
; (EXCLUIRM  '((CALCULO ((CAROL FABIO) (OTAVIO) COMP))) 'CALCULO 'CAROL )

;EXCLUI UM ALUNO DE VARIAS DISCIPLINAS
(DEFUN EXCLUIR-DISC-ALUNO (DISCIPLINAS ALUNO BD) 
	(IF(NULL (CAR DISCIPLINAS))
		(CONS (car BD) (cdr BD))
		(EXCLUIR-DISC-ALUNO (CDR DISCIPLINAS) ALUNO 
			(EXCLUIRM BD (CAR DISCIPLINAS) ALUNO )) 
	)
)

; TESTE
; (EXCLUIR-DISC-ALUNO '(CALCULO_A CALCULO_B) 'FABIO '((CALCULO_A ((CAROL FABIO) (MAGELA) COMP))) )

;EXCLUI VARIOS ALUNOS DE VARIAS DISCIPLINAS
(DEFUN CANCELAR-MATRICULA (ALUNOS DISCIPLINAS BD)
	(IF(NULL (CAR ALUNOS))
		(CONS (car BD) (cdr BD))
		(CANCELAR-MATRICULA  (CDR ALUNOS) DISCIPLINAS
			(EXCLUIR-DISC-ALUNO DISCIPLINAS (CAR ALUNOS)  BD)) 
	)
)

; TESTE
; (CANCELAR-MATRICULA '(CAROL FABIO) '(CALCULO FISICA) '((CALCULO ((CAROL FABIO) (OTAVIO) COMP)) (FISICA ((CAROL CAIO) (MAGELA) COMP))))

;EXCLUI UM PROFESSOR DE UMA DISCIPLINA
(DEFUN EXCLUIRP (L D P)
	(if (eql (caar l) d)            ; SE FOR IGUAL A DISCIPLINA
		(if (null(car (cdadar  l))) ; VERIFICA SE EXISTEM PROFESSORES
			(cons (car l) (cdr l))  ; NÃO EXISTE NENHUM PROFESSOR
			(if (existe (car (cdadar l)) P)
			(cons (cons d (cons (cons (cons (car (caadar l)) (cdr (caadar l)))
									(cons (excluir (car (cdadar l)) p) 
									(cdr (cdadar l)))) 
			nil)) (cdr l))         ; EXCLUI O PROFESSOR QUE DESEJO
			(cons (car l) (cdr l)) ; EXISTEM OUTROS PROFESSORES, MAS NÃO AQUELE QUE QUERO EXCLUIR 
			)
		)
		(if(null(car l))
			(cons (car l) (cdr l))                ; DISCIPLINA NÃO EXISTE
			(cons (car l) (EXCLUIRP (cdr l) d P)) ; PEGO PRÓXIMA DISCIPLINA
		)
	)
)

; TESTES
; PROFESSOR NÃO EXISTE NA DISCIPLINA
; (EXCLUIRP '() 'CALCULO 'OTAVIO )
; (EXCLUIRP '((APC     ((CAROL) (PATRICIA)     ))) 'CALCULO 'PATRICIA )
; (EXCLUIRP '((CALCULO ((FABIO) ()         COMP))) 'CALCULO 'OTAVIO )

; EXCLUI PROFESSOR NA DISCIPLINA
; (EXCLUIRP '((CALCULO ((CAROL) (OTAVIO)        COMP))) 'CALCULO 'OTAVIO )
; (EXCLUIRP '((CALCULO ((CAROL) (MAGELA OTAVIO) COMP))) 'CALCULO 'OTAVIO )
; (EXCLUIRP '((FISICA ((CAROL) (MAGELA OTAVIO) COMP)) (CALCULO ((CAROL) (MAGELA OTAVIO) COMP))) 'CALCULO 'OTAVIO )

;EXCLUI UM PROFESSOR DE VÁRIAS DISICIPLINAS
(DEFUN EXCLUIR-DISC-PROF (DISCIPLINAS PROF BD) 
	(IF(NULL (CAR DISCIPLINAS)) ; VERIFICA SE EXISTEM MAIS DISCIPLINAS DAS QUAIS QUERO EXCLUIR
		(CONS (car BD) (cdr BD))
		(EXCLUIR-DISC-PROF (CDR DISCIPLINAS) PROF 
			(EXCLUIRP BD (CAR DISCIPLINAS) PROF )) 
	)
)

; TESTES
; QUANDO SÓ EXISTE O PROFESSOR QUE SERÁ EXCLUIDO
; (EXCLUIR-DISC-PROF '() 		  'MAGELA '())
; (EXCLUIR-DISC-PROF '() 		  'OTAVIO '((CALCULO ((CAROL) (OTAVIO) COMP))))
; (EXCLUIR-DISC-PROF '(CALCULO_B) 'MAGELA '((CALCULO_B ((CAROL) (MAGELA) COMP))))

; EXCLUIDO DE MAIS DE UMA DISCIPLINA
; (EXCLUIR-DISC-PROF '(CALCULO_A CALCULO_B) 'MAGELA '((CALCULO_A ((CAROL) (OTAVIO MAGELA) COMP)) (CALCULO_B ((CAROL) (MAGELA) COMP))))

;EXCLUI VÁRIOS PROFESSORES DE VÁRIAS DISCIPLINAS
(DEFUN REMOVER-VINCULO (PROFESSORES DISCIPLINAS BD)
	(IF(NULL (CAR PROFESSORES))
		(CONS (car BD) (cdr BD))
		(REMOVER-VINCULO (CDR PROFESSORES) DISCIPLINAS
			(EXCLUIR-DISC-PROF DISCIPLINAS (CAR PROFESSORES)  BD)) 
	)
)

; TESTE
; (REMOVER-VINCULO '(MAGELA OTAVIO) '(CALCULO FISICA) '((CALCULO ((CAROL) (OTAVIO) . COMP)) (FISICA (() (MAGELA OTAVIO) . COMP))))

;RETORNA O NOME DO CURSO DA DISCIPLINA DESEJADA
(DEFUN DISC-CURSO? (DISCIPLINA BD) 
	(IF (NULL(CAAR BD)) ; VERIFICO SE EXISTE MAIS DISCIPLINAS
		NIL			    ; SE NÃO EXISTIR A DISCIPLINA NA LISTA
		(IF (EQL (CAAR BD) DISCIPLINA )       ; VERIFICO SE A DISCIPLINA É A AQUELA QUE DESEJO
			(cdr (cdadar BD))                 ; SE FOR RETORNO O CURSO, SE NÃO TIVER CURSO RETORNA NIL
			(DISC-CURSO? DISCIPLINA (CDR BD)) ; PEGO PRÓXIMA DISCIPLINA
		)
	)
)
; TESTES
; NÃO EXISTE NADA NA LISTA
; (DISC-CURSO? 'CALCULO '())

; EXISTE DISCIPLINA, MAS NÃO EXISTE CURSO
; (DISC-CURSO? 'CALCULO '((CALCULO((CAROL) (OTAVIO)))))

; EXISTE DISCIPLINA
; (DISC-CURSO? 'CALCULO '((CALCULO((CAROL) (OTAVIO) . ENGENHARIA))))

; NÃO EXISTE DISCIPLINA
; (DISC-CURSO? 'FISICA  '((CALCULO((CAROL) (OTAVIO) . ENGENHARIA))))

; EXISTE MAIS VALORES NA LISTA
; (DISC-CURSO? 'CALCULO '((FISICA ((CAROL) (MAGELA) . COMPUTACAO)) (CALCULO((CAROL) (OTAVIO) . ENGENHARIA))))

;RETORNA O NOME DE TODOS OS ALUNOS DE UMA DISCIPLINA
(DEFUN MATRICULADOS? (DISCIPLINA BD)
	(IF (NULL(CAAR BD)) ; VERIFICO SE EXISTEM MAIS DISCIPLINAS
		NIL				; NÃO TEM A DISCIPLINA NA LISTA
		(IF (EQL (CAAR BD) DISCIPLINA )         ; VERIFICO SE É IGUAL A DISCIPLINA DESEJADA
			(caadar BD)            				; SE FOR RETORNO A LISTA "INTERNA" DE ALUNOS DA DISCIPLINA
			(MATRICULADOS? DISCIPLINA (CDR BD)) ; SE NÃO PEGO A PRÓXIMA DISCIPLINA
		)
	)
)

; TESTE
; (MATRICULADOS? 'CALCULO '( (FISICA ((CAROL CAIO) (MAGELA) . COMPUTACAO)) (CALCULO((CAROL FABIO CAIO) (OTAVIO) . ENGENHARIA))))

;RETORNA TODOS OS PROFESSORES DE UMA DISCIPLINA
(DEFUN VINCULADOS? (DISCIPLINA BD) 
	(IF (NULL(CAAR BD)) ; VERIFICO SE EXISTEM MAIS DISCIPLINAS
		NIL				; NÃO EXISTE A DISCIPLINA NA LISTA
		(IF (EQL (CAAR BD) DISCIPLINA ) 	  ; VERIFICO SE É IGUAL A DISCIPLINA QUE EU DESEJO
			(car (cdadar  BD)) 				  ; SE FOR RETORNO A LISTA "INTERNA" DE PROFESSORES DA DISCIPLINA
			(VINCULADOS? DISCIPLINA (CDR BD)) ; SE NÃO PEGO A PRÓXIMA DISCIPLINA
		)
	)
)

; TESTES
; LISTA VAZIA
; (VINCULADOS? 'CALCULO '())

; EXISTE UM ELEMENTO
; (VINCULADOS? 'CALCULO '((CALCULO ((CAROL) (OTAVIO) . ENGENHARIA))))

; MAIS DE UM ELEMENTO
; (VINCULADOS? 'CALCULO '( (FISICA ((CAROL) (MAGELA ALEXANDRE) . COMPUTACAO)) (CALCULO((CAROL) (OTAVIO MAGELA) . ENGENHARIA))))

;RETORNA LISTA DE DISCIPLINAS CURSADAS POR UM ALUNO
(DEFUN CURSA? (ALUNO BD) 
	(IF (NULL(CAAR BD)) ; VERIFICO SE EXISTEM MAIS DISCIPLINAS
		NIL				; LISTA VAZIA
		(IF(NULL(caadar BD))              ; VERIFICO SE EXISTE UMA LISTA ALUNOS EM UMA DISCIPLINA
			(CURSA? ALUNO (CDR BD))	      ; SE NÃO PEGO A PRÓXIMA DISCIPLINA
			(IF(EXISTE (caadar BD) ALUNO) ; VERIFICO SE O ALUNO EXISTE NA LISTA "INTERNA" DE ALUNOS DE UMA DISCIPLINA
				(CONS (caar BD) (CURSA? ALUNO (CDR BD))) ; COLOCA NA LISTA EM CONSTRUÇÃO E PEGA PRÓXIMA DISCIPLINA
				(CURSA? ALUNO (CDR BD))   ; PEGO A PRÓXIMA DISCIPLINA
			)
		)
	)
)	

; TESTE
; NÃO EXISTE UMA LISTA DE ALUNOS EM UMA MAS DISCIPLINAS
;(CURSA? 'CAROL '((CALCULO(() (OTAVIO) . ENGENHARIA)) (FISICA((CAROL FABIO CAIO) (MAGELA) . COMPUTACAO))))

; EXISTE MAIS DE UMA DISCIPLINA CURSADA PELO ALUNO
;(CURSA? 'CAROL '((CALCULO((CAROL) (OTAVIO) . ENGENHARIA)) (FISICA((FABIO CAROL CAIO) (MAGELA) . COMPUTACAO))))

;RETORNA LISTA DE DISCIPLINAS MINISTRADAS POR UM PROFESSOR
(DEFUN MINISTRA? (PROFESSOR BD) 
	(IF (NULL(CAAR BD)) ; VERIFICO SE EXISTEM MAIS DISCIPLINAS
		NIL				; LISTA VAZIA
		(IF(NULL(car (cdadar BD)))					; VERIFICO SE EXISTE UMA LISTA PROFESSORES EM UMA DISCIPLINA
			(MINISTRA? PROFESSOR (CDR BD))          ; SE NÃO PEGO A PRÓXIMA DISCIPLINA
			(IF(EXISTE (car (cdadar BD)) PROFESSOR) ; VERIFICO SE O PROFESSOR EXISTE NA LISTA "INTERNA" DE PROFESSORES DE UMA DISCIPLINA
				(CONS (caar BD) (MINISTRA? PROFESSOR (CDR BD))) ; COLOCA NA LISTA EM CONSTRUÇÃO E PEGA PRÓXIMA DISCIPLINA
				(MINISTRA? PROFESSOR (CDR BD))      ; SE NÃO PEGO A PRÓXIMA DISCIPLINA
			)
		)
	)
)

; TESTE
; NÃO EXISTE UMA LISTA DE ALUNOS EM UMA MAS DISCIPLINAS
; (MINISTRA? 'OTAVIO '((FISICA((CAROL) (      ) . ENGENHARIA)) (CALCULO((FABIO) (MAGELA OTAVIO) . COMPUTACAO))))

; EXISTE MAIS DE UMA DISCIPLINA CURSADA PELO ALUNO
; (MINISTRA? 'OTAVIO '((FISICA((CAROL) (OTAVIO) . ENGENHARIA)) (CALCULO((FABIO) (MAGELA OTAVIO DANIELE) . COMPUTACAO))))

;RETIRA ELEMENTOS REPETIDOS
(DEFUN TIRA_REPETIDO (L)
	(IF (NULL (CAR L))
		L
		(IF (EQL(EXISTE (CDR L)(CAR L)) T)
			(TIRA_REPETIDO (CDR L))
			(CONS (CAR L)(TIRA_REPETIDO (CDR L)))
		)
	)
)

;TESTE
;(TIRA_REPETIDO '(1 2 3 4 3 2 1 5 6 1 3 4 1))

;RETORNA LISTA COM DISCIPLINAS SE EXISTIR ALUNO, PROFESSOR E CURSO
(DEFUN DISCIPLINAS? (BD)
	(IF (NULL (CAR BD)) ;lista bd vazia?
		NIL
		(IF (NULL (CAAR BD)) ;existe disciplina?
			(DISCIPLINAS? (CDR BD))
			(IF (NULL (CAADAR BD)) ;existe lista de aluno?
				(DISCIPLINAS? (CDR BD))
				(IF (NULL (CAR(CDADAR BD))) ;existe lista de professores?
					(DISCIPLINAS? (CDR BD))
					(IF (NULL (CDR(CDADAR BD))) ;existe curso?
						(DISCIPLINAS? (CDR BD))
						(TIRA_REPETIDO (CONS (CAAR BD)(DISCIPLINAS? (CDR BD))))	;se tudo existir, add disciplina na lista alem de tirar repetidos
					)	
				)
			)	 
		)
	)
)

;TESTES
;DISCIPLINA COM ALUNO E PROFESSOR
;(DISCIPLINAS? '((APC ((CAROL FABIO)(PATRICIA) . COMP))))
		
;DISCIPLINA SEM ALUNO
;(DISCIPLINAS? '((APC (()(PATRICIA) . COMP))))

;DISCIPLINA SEM PROFESSOR
;(DISCIPLINAS? '((APC ((CAROL FABIO)() . COMP))))

;DISCIPLINA SEM DISCIPLINA
;(DISCIPLINAS? '(( NIL ((CAROL FABIO)(PATRICIA) . COMP))))

;DISCIPLINA COM ALUNO E PROFESSOR 2
;(DISCIPLINAS? '((APC ((CAROL FABIO)(PATRICIA) . COMP)) ( CALCULO ((CAROL CAIO)(OTAVIO) . COMP))))

;INSERE ALUNOS DA LISTA (USO EXCLUSIVO PARA ALUNOS?)
(DEFUN INSERE_ALUNO (LISTA BD2)
	(IF (NULL (CDR LISTA))
		(CONS (CAR LISTA)(ALUNOS? (CDR BD2)))
		(CONS (CAR LISTA)(INSERE (CDR LISTA) BD2))
	)
)

;RETORNA LISTA COM TODOS OS ALUNOS QUE ESTIVEREM MATRICULADOS EM UMA DISCIPLINA
(DEFUN ALUNOS? (BD)
	(IF (NULL (CAR BD))
		NIL
		(IF (NULL (CAAR BD)) ;tem disciplina?
			(ALUNOS? (CDR BD)) ;se não
			(IF (NULL(CAADAR BD)) ;tem lista de aluno?
				(ALUNOS? (CDR BD)) ;se não
				(TIRA_REPETIDO (INSERE(CAADAR BD) BD)) ;tiro repetido da lista o qual insiro os alunos, retornando uma lista sem alunos repetidos
			)
		)
	)	
)

;TESTES
;NORMAL
;(ALUNOS? '((APC ((CAROL FABIO)(PATRICIA) . COMP))))

;SEM DISCIPLINA
;(ALUNOS? '((NIL ((CAROL FABIO)() . COMP))))

;SEM DISCIPLINA NO PRIMEIRO
;(ALUNOS? '((  ((CAROL FABIO)(PATRICIA) . COMP))(CALCULO ((CAIO FABIO REINALDO)(OTAVIO) . COMP))))

;INSERE PROFESSORES DA LISTA (USO EXCLUSIVO PARA PROFESSORES?)
(DEFUN INSERE_PROF (LISTA BD2)
	(IF (NULL (CDR LISTA))
		(CONS (CAR LISTA)(PROFESSORES? (CDR BD2)))
		(CONS (CAR LISTA)(INSERE (CDR LISTA) BD2))
	)
)

(DEFUN PROFESSORES? (BD)
	(IF (NULL (CAR BD))
		NIL
		(IF (NULL (CAAR BD)) ;tem disciplina?
			(PROFESSORES? (CDR BD)) ;se não
			(IF (NULL(CAR(CDADAR BD))) ;tem lista de professor?
				(PROFESSORES? (CDR BD)) ;se não
				(TIRA_REPETIDO (INSERE_PROF(CAR(CDADAR BD)) BD)) ;tiro repetido da lista o qual insiro os professores, retornando uma lista sem professores repetidos
			)
		)
	)	
)

;TESTES
;NORMAL
;(PROFESSORES? '((APC ((CAROL FABIO)(PATRICIA) . COMP))))

;SEM DISCIPLINA
;(PROFESSORES? '(( ((CAROL FABIO)(PATRICIA) . COMP))(CALCULO ((CAROL CAIO)(OTAVIO) . COMP))))

;NORMAL 2
;(PROFESSORES? '((APC  ((CAROL FABIO)(PATRICIA) . COMP))(CALCULO ((CAIO FABIO REINALDO)(OTAVIO) . COMP))))